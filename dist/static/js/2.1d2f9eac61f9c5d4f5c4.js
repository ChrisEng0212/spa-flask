webpackJsonp([2,5],{DRJR:function(t,e){},RL9h:function(t,e){},dHcL:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("fZjL"),a=s.n(n),i=s("Dd8w"),r=s.n(i),l=s("XdxJ"),o=s("ZE+q"),c=s("OLUw"),u=s("gyMJ"),d={name:"Match",props:{s3:String,friends:Object},components:{TransMatch:l.default,TypeMatch:o.default},data:function(){return{fields:[{key:"id"}],selected:"true",waiter:[],challenger:[],pageHead:"Match Area",friendAdder:!1,friendDeleter:!1,friend:{username:null,userID:null},username:null,userID:null,socket:null,testType:null,p1:null,p2:null,p1name:null,p2name:null,player:null,gameOver:!1,message:null,waiting:!0,msg:null,challengeMode:null,gameSelect:"TransEng",gameTypes:[{value:"TransEng",text:"En > Ch"},{value:"TransCh",text:"Ch > En"},{value:"TypeMatch",text:"Spelling"}],gameColors:{TransEng:"second",TransCh:"warn",TypeMatch:"safe"},classColors:{TransEng:"buttonDiv bg-info",TransCh:"buttonDiv bg-warn",TypeMatch:"buttonDiv bg-safe"}}},methods:{filterOnline:function(t){if(1===t.status||2===t.status)return!0},filterOffline:function(t){if(0===t.status)return!0},filterChallenge:function(t){if(3===t.status)return!0},filterWaiting:function(t){if(4===t.status)return!0},showModal:function(){this.$refs.success.show()},showAlert:function(){this.$refs.fail.show()},showQuit:function(){this.$refs.quit.show()},hideModal:function(t){"success"===t?(this.$refs.success.hide(),this.waiting=!0):"success"===t?(this.$refs.fail.hide(),this.waiting=!0):"cancel"===t?this.$refs.quit.hide():"quit"===t&&this.gameOver?(this.$refs.quit.hide(),this.$emit("resetMatch",{friends:this.friends}),this.closeSocket()):"quit"===t&&(console.log("FRIENDS",this.friends),this.$refs.quit.hide(),this.$emit("resetMatch",{friends:this.friends}),this.socket.emit("resetEmit",{player:this.username}))},getName:function(t){var e=t.split(" ");return e[1]?e[0]+" "+e[1][0]:(console.log(e[0]),t)},startSocket:function(){console.log("STARTSOCKET"),this.socket=Object(c.a)(),this.socket.emit("checkOnline",{userID:this.userID})},closeSocket:function(){this.socket.close()},leaveMatch:function(){this.$store.dispatch("testActive",!1),console.log("leaveActivated"),this.msg="Warning, you are about to leave the game",this.showQuit()},challengeSend:function(t,e){var s={userID:this.userID,username:this.username,targetID:t,mode:e,action:"send"};console.log("send challenge",s),this.socket.emit("challenge",s),this.friends.find(function(e){return e.id===t}).status=3},challengeRetract:function(t,e){var s={userID:this.userID,username:this.username,targetID:t,mode:"mode",action:"retract"};console.log("retract challenge",s),this.socket.emit("challenge",s),this.friends.find(function(e){return e.id===t}).status=1},declineChallenge:function(t,e){var s={userID:this.userID,username:this.username,targetID:t,mode:"mode",action:"decline"};console.log("decline challenge",s),this.socket.emit("challenge",s),this.friends.find(function(e){return e.id===t}).status=1},acceptChallenge:function(t,e){var s={userID:this.userID,username:this.username,targetID:t,mode:e,action:"accept"};console.log(" accept challenge",s),this.socket.emit("challenge",s)},addFriend:function(){this.waiting=!1;var t=this,e=this.friend.username,s=this.friend.userID;return Object(u.d)({friendName:e,friendID:s,userID:t.userID}).then(function(n){n.data.check&&n.data.friendID!==t.userID?(console.log("response",n.data),t.friends=JSON.parse(n.data.friends),t.$store.dispatch("addFriend",{friendData:JSON.parse(n.data.friends)}),t.msg="Friend added:"+e+" #"+s,t.$emit("resetMatch"),t.showModal()):(t.msg="Cannot add friend. Please check username and user ID",t.showAlert())}).catch(function(t){console.log("Error Registering: ",t)})},deleteFriend:function(t){this.waiting=!1;var e=this;return Object(u.e)({friendID:t,userID:e.userID}).then(function(t){t.data.check?(console.log("response",t.data),e.friends=JSON.parse(t.data.friends),e.$store.dispatch("addFriend",{friendData:JSON.parse(t.data.friends)}),e.msg="Friend Deleted",e.showModal()):(e.msg="Cannot delete friend right now",e.showAlert())}).catch(function(t){console.log("Error Deleting: ",t)})}},created:function(){var t=this;window.onbeforeunload=function(){t.isAuthenticated&&!1===t.$store.state.updateStatus&&t.closeSocket()}},beforeDestroy:function(){console.log("beforeDestroyMatch"),this.closeSocket()},mounted:function(){this.userID=this.$store.state.userProfile.userID,this.username=this.$store.state.userProfile.username,this.startSocket();var t=this;t.socket.on("offlineUsers",function(e){console.log("offlineUsers",e),t.friends.find(function(t){return t.id===e.userID}).status=0}),t.socket.on("onlineUsers",function(e){(console.log("onlineUsers",e,r()({},t.friends)),e.friends)?0===a()(t.friends).length&&(t.friends=e.friends):t.friends.find(function(t){return t.id===e.userID}).status=1}),t.socket.on("busy",function(e){console.log("busy",e);var s=t.friends.find(function(t){return t.id===e.userID}),n=t.friends.find(function(t){return t.id===e.targetID});"send"===e.action?(s.status=2,n.status=2):"decline"===e.action?s.status=1:(s.status=1,n.status=1)}),t.socket.on("challengeMatch",function(e){console.log("challengeMatch",e);var s=t.friends.find(function(t){return t.id===e.userID});"decline"===e.action?s.status=1:"retract"===e.action?s.status=1:(s.status=4,s.mode=e.mode,t.challengeMode=e.mode)}),t.socket.on("start",function(e){console.log("start",e),t.$store.dispatch("testActive",!0),t.testType=e.mode;var s=t.friends.find(function(t){return t.id===e.p1});s?(t.player="p2",t.p1=e.p1,t.p1name=s.name):void 0===s?(t.player="p1",t.p1=e.p1,t.p1name=t.username):console.log("PLAYER ERROR"),t.p2=e.p2,t.p2name=e.p2name,console.log("player",t.player)}),t.socket.on("leaveRoom",function(e){t.gameOver=!0,console.log("reset",e),t.msg="Game Ended, "+e.opponent+" has left the game",t.showQuit()})}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"matchArea"},[t.testType&&"r"===t.testType[1]?s("TransMatch",{attrs:{testType:t.testType,gameOver:t.gameOver,p1:t.p1,p2:t.p2,p1name:t.p1name,p2name:t.p2name,player:t.player,socket:t.socket,s3:t.s3},on:{leave:function(e){return t.leaveMatch()}}}):t._e(),t._v(" "),t.testType&&"y"===t.testType[1]?s("TypeMatch",{attrs:{testType:t.testType,gameOver:t.gameOver,p1:t.p1,p2:t.p2,p1name:t.p1name,p2name:t.p2name,player:t.player,socket:t.socket,s3:t.s3},on:{leave:function(e){return t.leaveMatch()}}}):t._e(),t._v(" "),t.waiting&&null!==t.friends?[null===t.testType?s("div",[t._m(0),t._v(" "),s("div",{staticClass:"bg-grey text-third"},[s("b-row",{attrs:{align:"center"}},[s("b-col",[s("div",{staticStyle:{color:"red !important"}},[s("b-form-radio-group",{staticStyle:{width:"100%"},attrs:{id:"btn-radios-2",options:t.gameTypes,buttons:"","button-variant":t.gameColors[t.gameSelect],name:"radio-btn-outline"},model:{value:t.gameSelect,callback:function(e){t.gameSelect=e},expression:"gameSelect"}})],1)])],1)],1),t._v(" "),t.friendAdder?s("div",{staticClass:"bg-prime p-2"},[s("b-row",{attrs:{no:"",gutters:""}},[s("b-col",[s("b-form",{attrs:{inline:""}},[s("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"inline-form-input-name",placeholder:"Friend name"},model:{value:t.friend.username,callback:function(e){t.$set(t.friend,"username",e)},expression:"friend.username"}}),t._v(" "),s("b-input-group",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{prepend:"#"}},[s("b-input",{attrs:{id:"inline-form-input-username",placeholder:"user ID"},model:{value:t.friend.userID,callback:function(e){t.$set(t.friend,"userID",e)},expression:"friend.userID"}})],1)],1)],1),t._v(" "),s("b-col",[s("button",{staticClass:"buttonDiv bg-third",staticStyle:{width:"100px"},on:{click:function(e){return t.addFriend()}}},[t._v("Add")])])],1)],1):t._e(),t._v(" "),s("div",{staticClass:"bg-smoke text-prime p-2"},[s("b-table",{attrs:{items:t.friends,fields:t.fields,"thead-class":"d-none",filter:t.selected,"filter-function":t.filterWaiting},scopedSlots:t._u([{key:"cell(id)",fn:function(e){return[s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("div",{staticClass:"nameTag bg-p1 pt-2"},[s("b-row",[s("b-col",{attrs:{cols:"3"}},[s("b-avatar",{staticClass:"ml-2",attrs:{src:t.s3+e.value+"/avatar.jpg",size:"1.5rem"}})],1),t._v(" "),s("b-col",[s("span",[t._v(" "+t._s(t.getName(e.item.name))+" ")]),t._v(" "),s("b-icon",{staticClass:"mr-2 mt-1",staticStyle:{float:"right"},attrs:{icon:"circle-fill",animation:"throb"}})],1)],1)],1)]),t._v(" "),s("b-col",[s("button",{class:t.classColors[t.challengeMode],staticStyle:{width:"60%",height:"40px"},on:{click:function(s){return t.acceptChallenge(e.item.id,e.item.mode)}}},[s("b-icon",{staticClass:"text-prime",attrs:{icon:"box-arrow-in-left"}})],1),t._v(" "),s("b-icon",{staticClass:"text-alert mt-1",staticStyle:{float:"right"},attrs:{"font-scale":"1.5",icon:"x-square-fill"},on:{click:function(s){return t.declineChallenge(e.item.id)}}})],1)],1)]}}],null,!1,642041815),model:{value:t.waiter,callback:function(e){t.waiter=e},expression:"waiter"}}),t._v(" "),s("b-table",{attrs:{items:t.friends,fields:t.fields,"thead-class":"d-none",filter:t.selected,"filter-function":t.filterChallenge},scopedSlots:t._u([{key:"cell(id)",fn:function(e){return[s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("div",{staticClass:"nameTag bg-p2 pt-2"},[s("b-row",[s("b-col",{attrs:{cols:"3"}},[s("b-avatar",{staticClass:"ml-2",attrs:{src:t.s3+e.value+"/avatar.jpg",size:"1.5rem"}})],1),t._v(" "),s("b-col",[s("span",[t._v(" "+t._s(t.getName(e.item.name))+" ")]),t._v(" "),s("b-icon",{staticClass:"mr-2 mt-1",staticStyle:{float:"right"},attrs:{icon:"circle-fill",animation:"throb"}})],1)],1)],1)]),t._v(" "),s("b-col",[s("b-icon",{staticClass:"text-alert mt-2",staticStyle:{float:"right"},attrs:{"font-scale":"1.5",icon:"x-square-fill"},on:{click:function(s){return t.challengeRetract(e.item.id)}}})],1)],1)]}}],null,!1,143342247),model:{value:t.challenger,callback:function(e){t.challenger=e},expression:"challenger"}}),t._v(" "),0===t.waiter.length&&0===t.challenger.length?s("b-table",{attrs:{items:t.friends,fields:t.fields,"thead-class":"d-none",filter:t.selected,"filter-function":t.filterOnline},scopedSlots:t._u([{key:"cell(id)",fn:function(e){return[1===e.item.status?s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("div",{staticClass:"nameTag bg-safe pt-2"},[s("b-row",[s("b-col",{attrs:{cols:"3"}},[s("b-avatar",{staticClass:"ml-2",attrs:{src:t.s3+e.value+"/avatar.jpg",size:"1.5rem"}})],1),t._v(" "),s("b-col",[s("span",[t._v(" "+t._s(t.getName(e.item.name))+" ")]),t._v(" "),s("b-icon",{staticClass:"mr-2 mt-1",staticStyle:{float:"right"},attrs:{icon:"circle-fill",animation:"throb"}})],1)],1)],1)]),t._v(" "),s("b-col",[s("button",{class:t.classColors[t.gameSelect],staticStyle:{width:"60%",height:"40px"},on:{click:function(s){return t.challengeSend(e.value,t.gameSelect)}}},[s("b-icon",{staticClass:"text-prime",attrs:{icon:"box-arrow-in-right"}})],1)])],1):s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("div",{staticClass:"nameTag bg-warn pt-2"},[s("b-row",[s("b-col",{attrs:{cols:"3"}},[s("b-avatar",{staticClass:"ml-2",attrs:{src:t.s3+e.value+"/avatar.jpg",size:"1.5rem"}})],1),t._v(" "),s("b-col",[s("span",{staticClass:"text-cream"},[t._v(" "+t._s(t.getName(e.item.name))+" ")]),t._v(" "),s("b-icon",{staticClass:"mr-2 mt-1",staticStyle:{float:"right"},attrs:{icon:"circle-fill",animation:"throb"}})],1)],1)],1)])],1)]}}],null,!1,161013104)}):t._e(),t._v(" "),0===t.waiter.length&&0===t.challenger.length?s("b-table",{attrs:{items:t.friends,fields:t.fields,"thead-class":"d-none",filter:t.selected,"filter-function":t.filterOffline},scopedSlots:t._u([{key:"cell(id)",fn:function(e){return[s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("div",{staticClass:"nameTag bg-alert pt-2"},[s("b-row",[s("b-col",{attrs:{cols:"3"}},[s("b-avatar",{staticClass:"ml-2",attrs:{src:t.s3+e.value+"/avatar.jpg",size:"1.5rem"}})],1),t._v(" "),s("b-col",[s("span",{staticClass:"text-cream"},[t._v(" "+t._s(t.getName(e.item.name))+" ")]),t._v(" "),s("b-icon",{staticClass:"mr-2 mt-1",staticStyle:{float:"right"},attrs:{icon:"exclamation-circle"}})],1)],1)],1)])],1)]}}],null,!1,2697624023)}):t._e()],1)]):t._e()]:[s("div",{staticClass:"mt-5",attrs:{align:"center"}},[s("h4",{staticClass:"text-prime"},[t._v(" Updating.... ")]),t._v(" "),s("b-icon",{attrs:{icon:"person",animation:"throb",variant:"prime","font-scale":"6"}})],1)],t._v(" "),s("b-modal",{ref:"success",attrs:{align:"center","hide-footer":"",title:"Complete","hide-header-close":"","no-close-on-esc":"","no-close-on-backdrop":""}},[s("div",{staticClass:"d-block"},[s("h3",[t._v(" "+t._s(t.msg)+" ")])]),t._v(" "),s("button",{staticClass:"buttonDiv mt-3 bg-safe text-cream",staticStyle:{width:"60%"},on:{click:function(e){return t.hideModal("success")}}},[t._v("Close")])]),t._v(" "),s("b-modal",{ref:"fail",attrs:{align:"center","hide-footer":"",title:"Problem Found","hide-header-close":"","no-close-on-esc":"","no-close-on-backdrop":""}},[s("div",{staticClass:"d-block"},[s("h3",[t._v(" "+t._s(t.msg)+" ")])]),t._v(" "),s("button",{staticClass:"buttonDiv mt-3 bg-alert text-cream",staticStyle:{width:"60%"},on:{click:function(e){return t.hideModal("fail")}}},[t._v("Close")])]),t._v(" "),s("b-modal",{ref:"quit",attrs:{align:"center","hide-footer":"",title:"Game Over","hide-header-close":"","no-close-on-esc":"","no-close-on-backdrop":""}},[s("div",{staticClass:"d-block"},[s("h3",[t._v(" "+t._s(t.msg)+" ")])]),t._v(" "),s("button",{staticClass:"buttonDiv mt-3 bg-alert text-prime",staticStyle:{width:"60%"},on:{click:function(e){return t.hideModal("quit")}}},[t._v("Quit")]),t._v(" "),s("button",{staticClass:"buttonDiv mt-3 bg-grey text-prime",staticStyle:{width:"60%"},on:{click:function(e){return t.hideModal("cancel")}}},[t._v("Cancel")])])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mt-2 p-2 bg-grape head"},[e("h2",{staticClass:"text-cream",attrs:{align:"center"}},[this._v("\n              Match Zone\n            ")])])}]};var h=s("VU/8")(d,f,!1,function(t){s("RL9h")},"data-v-ab1afb00",null);e.default=h.exports},taOX:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("dHcL"),a={name:"MatchBase",props:{s3:String},components:{Match:n.default},data:function(){return{marker:!0,startTimer:null,friends:{}}},methods:{reset:function(t){console.log("RESET ACTIVE",t),this.friends=t.friends,this.marker=!1;var e=this;e.startTimer=setTimeout(function(){e.marker=!0},2e3)}},beforeDestroy:function(){this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null)},beforeMount:function(){return this.$store.getters.isAuthenticated?""===this.$store.state.userProfile.classroom?(alert("No class found"),this.$router.push("account"),!1):void 0:(this.$router.push("login"),!1)}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"matchBase"},[t.marker?s("Match",{attrs:{s3:t.s3,friends:t.friends},on:{resetMatch:function(e){return t.reset(e)}}}):s("div",{attrs:{align:"center"}},[s("h4",{staticClass:"text-prime"},[t._v(" Reloading ")]),t._v(" "),s("b-icon",{attrs:{icon:"three-dots",animation:"cylon",variant:"prime","font-scale":"6"}})],1)],1)},staticRenderFns:[]};var r=s("VU/8")(a,i,!1,function(t){s("DRJR")},"data-v-60139313",null);e.default=r.exports}});
//# sourceMappingURL=2.1d2f9eac61f9c5d4f5c4.js.map